{% extends "base.html" %}
{% block title %}Редактирование профиля{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto py-10 px-4">
  <div class="bg-white shadow rounded-lg p-6">
    <h1 class="text-xl font-bold mb-4">Редактировать профиль</h1>

    {% if error %}
      <div class="bg-red-100 text-red-700 border border-red-300 px-4 py-2 rounded mb-4">{{ error }}</div>
    {% endif %}
    {% for category, message in get_flashed_messages(with_categories=True) %}
      <div class="bg-green-100 text-green-700 border border-green-300 px-4 py-2 rounded mb-4">{{ message }}</div>
    {% endfor %}

    <form method="post" enctype="multipart/form-data" class="space-y-5">
      <div class="flex items-center gap-4">
        <img
          src="{{ current_user.avatar_url or 'https://api.dicebear.com/7.x/initials/svg?seed=' ~ current_user.username }}"
          class="w-20 h-20 rounded-full object-cover border" alt="avatar">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1" for="avatar">Аватар (png/jpg/gif/webp)</label>
          <input id="avatar" name="avatar" type="file" accept=".png,.jpg,.jpeg,.gif,.webp"
                 class="block w-full text-sm text-gray-700">
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1" for="full_name">Имя</label>
        <input id="full_name" name="full_name" type="text" value="{{ current_user.full_name }}"
               class="w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1" for="bio">О себе</label>
        <textarea id="bio" name="bio" rows="4"
                  class="w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-blue-300">{{ current_user.bio }}</textarea>
      </div>

      <div class="flex gap-3">
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Сохранить</button>
        <a href="{{ url_for('profile') }}" class="px-4 py-2 border rounded text-gray-700 hover:bg-gray-50">Отмена</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
